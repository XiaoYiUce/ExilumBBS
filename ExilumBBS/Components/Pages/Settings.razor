@page "/settings"
@using ExilumBBS.State

@inject AppState appState
@inject UserState userState
@inject ITokenService tokenService
@inject IUserService userService

@layout WithBackLayout

<MCellGroup>
    <MCell Title="退出登录" OnClick="Logout"></MCell>
</MCellGroup>


@code {
    protected override async Task OnParametersSetAsync()
    {
        await base.OnParametersSetAsync();
        // 设置AppBar标题
        appState.WithbackLayoutState.AppBarTitle = "设置";
    }

    private async Task Logout()
    {
        if (userState.Token != null)
        {
            await tokenService.DeleteTokenAsync(userState.Token);
        }

        if (userState.CurrentUserProfile != null)
        {
            await userService.DeleteUserProfile(userState.CurrentUserProfile.Uid);
        }

    }
}
